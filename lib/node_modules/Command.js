"use strict"

import Promise from 'bluebird'
import fs from 'fs'
import ursa from 'ursa'
import expandHomeDir from 'expand-home-dir'

Promise.promisify(fs.readFile)

class Command {
    constructor(opts) {
        this.opts = opts
    }

    encrypt() {
        const {keyFile, ...cmd} = this.opts
        const privKey = ursa.createPrivateKey(fs.readFileSync(expandHomeDir(keyFile), {encoding: 'utf8'}))

        return privKey.privateEncrypt(JSON.stringify(cmd))
    }
}

export default Command